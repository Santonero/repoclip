<% content_for :head do %>
  <meta name="turbo-visit-control" content="reload">
  <%= stylesheet_link_tag "https://vjs.zencdn.net/8.3.0/video-js.css" %>
  <%= javascript_import_module_tag "videojs" %>
<% end %>

<% if notice %>
  <div class="toast toast-success"><button class="btn btn-clear float-right" onclick="document.body.removeChild(this.parentNode)"></button><%= notice %></div>
<% end %>
<% if alert %>
  <div class="toast toast-error"><button class="btn btn-clear float-right" onclick="document.body.removeChild(this.parentNode)"></button><%= alert %></div>
<% end %>
<%= render "navbar" %>
<div class="container grid-xl" id="loader-container" style="margin-left:initial;display:flex;align-items:center;justify-content:center;">
  <div class="loading loading-lg"></div>
</div>
<%= render @video %>
<div data-controller="play"></div>
<div class="container" id="comcont">
  <div class="divider hidden"></div>
  <div class="container">
    <%= render 'comments/ccount' %>
  </div>
  <div id="comments" class="column col-12 hidden" style="width:99.3%;">
    <%= render @video.comments %>
  </div>
  <h5 class="container">Add a comment:</h5>
  <div class="column col-9 col-xs-12 col-sm-12 col-md-11 col-lg-9 p-2" style="margin-bottom:16px;">
    <%= turbo_frame_tag "new_comment", src: new_video_comment_path(@video) %>
  </div>
</div>
<script>
window.addEventListener('load', () => {
  document.getElementById('loader-container').style.display ="none";
  document.querySelector('.divider').classList.remove('hidden');
  document.getElementById('comments').classList.remove('hidden');
  const ph = document.getElementsByClassName('placeholder');
  window.setTimeout(removePlaceholder, 800);
  function removePlaceholder() {
    while(ph.length){
      ph[0].classList.remove('placeholder');
    }
  }
})
</script>
